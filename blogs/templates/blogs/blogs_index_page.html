{% extends "base.html" %}

{% load tz %}
{% load hitcount_tags %}
{% load wagtailcore_tags wagtailimages_tags %}

{% load static %}
{% load wagtailcore_tags %}

{% block body_class %}template-magazineindexpage{% endblock %}

{% block extra_css %}
<style>
    .card-title {
        text-transform: uppercase;
        font-size: 22px;
    }
    .star-icon {
        margin-right: 5px;
        color: gold;
    }
    .blog-date {
        font-size: 14px;
        color: #888888;
    }
    .author-category-date {
        font-size: 12px;
        color: #888888;
    }
    .folder-icon {
        margin-right: 5px;
    }
    .card-text {
        word-wrap: break-word;
    }
    .teaser-section {
        column-count: 3;
        column-gap: 20px;
    }
</style>
{% endblock %}

{% block content %}
<!-- <a href="{% url 'blogs:create_blog' %}">Create Blog Post</a> -->


    <h1>
        {{ page.title }}
    </h1>

    <div class="intro">
        {{ page.intro | richtext }}
    </div>

    {% if blogs %}
        <div class="card-body">
            <article class="box page-content">
                {% image blog.display_image fill-800x240 as my_image %}
                {% for blog in blogs %}
                    <section>
                        <h5 class="card-title font-weight-bold">
                            <i class="fa fa-star star-icon" aria-hidden="true"></i>{{ blog.title }}
                        </h5>
                        {% if my_image %}
                            <span class="img-responsive">
                                <img src="{{ my_image.url }}" class="card-img-top" alt="{{ my_image.alt }}" />
                            </span>
                        {% endif %}
                        <p class="author-category-date">
                            <i class="fa fa-user" aria-hidden="true"></i>
                            <a href="?author={{ blog.author.id }}">{{ blog.author.email }}</a>
                            &nbsp;&nbsp;
                            <i class="fa fa-folder folder-icon" aria-hidden="true"></i>
                            <a href="?category={{ blog.category }}">{{ blog.category }}</a>
                            &nbsp;&nbsp;
                            <i class="fa fa-calendar" aria-hidden="true"></i>
                            {{ blog.start_date | timezone:"Africa/Nairobi" | date:"F d, Y" }} Africa/Nairobi
                        </p>
                        {% if blog.teaser %}
                            <div class="teaser-section">
                                {{ blog.teaser | richtext }}
                            </div>
                            <p><a href="{% pageurl blog %}">Continue Reading</a></p>
                        {% endif %}
                    </section>
                {% endfor %}
            </article>
        </div>

        <div class="step-links ms-3 mt-1 text-center">
            {% if blogs.has_previous %}
                <a href="?page={{ blogs.previous_page_number }}" class="btn btn-outline-primary btn-sm">Previous</a>
            {% endif %}

            <span class="current">
                Page {{ blogs.number }} of {{ blogs.paginator.num_pages }}
            </span>

            {% if blogs.has_next %}
                <a href="?page={{ blogs.next_page_number }}" class="btn btn-outline-primary btn-sm">Next</a>
            {% endif %}
        </div>
    {% else %}
        <p>There are no blogs</p>
    {% endif %}
{% endblock %}
